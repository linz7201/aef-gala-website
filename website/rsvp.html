<!-- 
    RSVP page is created for users to put in their information like their
    name, phone number, email address, and the number of guests they are
    bringing to the AEF Gala. The internal scripts at the end of the file
    help animate and give functionality to the expandable guest list input
    and provide for form validations making sure each input is filled out
    and within the correct format.
 -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>AEF Gala - Registration</title>
        <link rel="icon" href="images/logo.png">
        <link rel="stylesheet" type="text/css" href="css/template-styles.css">
        <link rel="stylesheet" type="text/css" href="css/register-styles.css">
        <!--External Script -->
        <script src="./scripts/nav-bar.js"></script>
        <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">

        <style>
            /* Adding media queries or viewports to change design based on device */
            body{
                background: url(images/watercolor3.png), url(images/watercolor6.png);
                background-size: 60%, 45%;
                background-position: left -62% top -70%, right -25% bottom -580%;
                background-repeat: no-repeat;
            }
            @media (max-width:1200px) {
                body{
                    background-position: left -300px top -150px, right -130px bottom -400px;
                }
            }
            @media (max-width:940px) {
                body{
                    background-position: left -230px top -90px, right -150px bottom -200px;
                }
            }
        </style>
    </head>
    <body>
        <div class="header" id="navbar">
            <header>
            <ul>
                <li class="logo"><img src="images/aef_logo_c.png"></li>
                <li><a href="gala.html">The Gala</a></li>
                <li><a href="support.html">Support Us</a></li>
                <li><a href="#about.html">About AEF</a></li>
                <li><a href="#sponsors.html">Our Sponsors</a></li>
                <li><a href="#contact.html">Contact Us</a></li>
                <li class="icon"><a href="javascript:void(0);" class="icon" onclick="onMenuClick()"><img src="./images/hamburger.png"></a></li>
            </ul>
            </header>
        </div>
        <div class="content">
            <!-- content lies here -->
            <h1>Rsvp for Gala</h1>
            <img src="./images/topflowers.png" id="topflowers">

            <div class="form-area">
                <form id="gala-registration" name="input" method="post">
                    <section class="input name">
                        <label for="fullName">Name <span class="asterisk">*</span></label>
                        <input type="text" id="fullName" class="required" name="fullName" placeholder="John Doe" onchange="isEmpty(this, 'fullNameEmpty');">
                        <small id="fullNameEmpty" class="errorMsg hidden">Input required</small>
                    </section>
                    <section class="contactInput">
                        <section class="input phone">
                            <label for="phoneNumber">Phone Number <span class="asterisk">*</span></label>
                            <input type="tel" id="phoneNumber" class="required" name="phoneNumber" placeholder="123-456-7890" onchange="isEmpty(this, 'phoneNumberEmpty'); formatPhone(this); validate(this, /^\d{3}[-]\d{3}[-]\d{4}$/, 'phoneError');">
                            <small id="phoneError" class="errorMsg hidden">Input must follow format: XXX-XXX-XXXX</small>
                            <small id="phoneNumberEmpty" class="errorMsg hidden">Input required</small>
                        </section>
                        <section class="input email">
                            <label for="emailAddress">Email Address <span class="asterisk">*</span></label>
                            <input type="text" id="emailAddress" class="required" name="emailAddress" placeholder="johndoe@email.com" onchange="isEmpty(this, 'emailAddressEmpty'); validate(this, /^[A-Za-z0-9._-]+\@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/, 'emailError');">
                            <small id="emailError" class="errorMsg hidden">Input must be a valid email</small>
                            <small id="emailAddressEmpty"class="errorMsg hidden">Input required</small>
                        </section>
                    </section>
                    <section class="guestInput">
                        <label for="guestNames">Guest Name(s):</label>
                        <section id="guestForm">
                            <input type="text" class="guestNames" name="guestName" placeholder="(optional)" onchange="isGuestEmpty(this, 0)">
                        </section>
                        <label >Number of Guests: <span id="guestCount">0</span></label>
                    </section>
                    
                    <section id="submit">
                        <input id="submit-form" type="submit" value="Submit">
                    </section>
                </form>
            </div><img src="./images/bottomflowers.png" id="bottomflowers">
            </div>
        </div>
        <div class="footer">
            <footer>
                <table id="contact">
                    <tr >
                        <td id="firstcontactcol">Contact</td>  <td id="lastcontactrcol"><a href="mailto:support@aef4kids.com">support@aef4kids.com</a></td>
                    </tr>
                  
                    <tr >
                        <td id="firstcontactcol"><a href="tel:+16269433080">1(626) 943-3080</a></td>
                    <td id="lastcontactrcol"><a>Mon-Fri 8AM - 4PM</a></td>
                    </tr>
    
                    <tr>
                       <td colspan="2">Copyright &#169; 2023 AEF Gala. All Rights Reserved.</td> 
                    </tr>
                    
                    
                </table>
                <ul id="footer-aef-logo">
                    <li><a href="https://www.aef4kids.com/"><img src="images/footerlogo.png"></a></li>
                    <!-- <li><img src="./images/aef_word.png"></li> -->
                </ul>
                <ul id="socials">
                    <!--<li><button id="subscribe">Subscribe to Our Newsletter</button></li>-->
                    <li><a href="https://maps.app.goo.gl/qEAL8jCuaeZ5Wijj8" target="_blank">1603 Chestnut Street, Alhambra, CA 91803</a></li>
                    <br>
                    <br>
                    <li><ul>
                        <li><a href="https://www.instagram.com/aef4kids?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="><img src="./images/instagram.png" alt="Instagram"></a></li>
                        <li><a href="https://www.facebook.com/aef4kids?eid=ARAqSVb9qq_IHO6O2yPmLuli-qXn0Z8K9nQC-h7ahCwlXy4J5KJQ7nLIIES4IsnYtFyYTVqKRAItZ-kq"><img src="./images/facebook.png" alt="Facebook"></a></li>
                        <li><a href="
                            https://www.youtube.com/channel/UCCwoIYXVtG1D2bxsl2aiOXg"><img src="./images/youtube.png" alt="YouTube"></a></li>
                         <li><a href="mailto:support@aef4kids.com"><img src="images/gmail.png" alt="Gmail"></a></li>
                    </ul></li>
                </ul>
            </footer> 
            <!--<img src="/images/watercolor1.png" id="botrightwatercolor">-->
        </div>
    </body>
    <!--Implement form validation script-->
    <script type="text/javascript" src="scripts/register-form.js"></script>
    <!-- Internal Script for Guest Input Form-->
    <script>
        let index = 1;
        const guestCount = document.getElementById("guestCount");
        /*
            creates function to add an input box for an additional guest input
            if the user fills in the previous input box
        */
        function addGuestInput(){
            // creates an element called input, ready to be added to the document
            let newGuestInput = document.createElement("input");
            // adding attributes for input
            newGuestInput.type = "text";
            newGuestInput.classList.add("guestNames");
            newGuestInput.name = "guestName"+index.toString();
            newGuestInput.placeholder = "(optional)";
            newGuestInput.onchange = (function(idx) {
                return function() {
                    isGuestEmpty(this, idx);
                };
            })(index);
            index++;
            // adds the element called input into the document 
            document.getElementById("guestForm").appendChild(newGuestInput);
            guestCount.textContent = index - 1;
        }
        /*
            creates function to remove an input box if the user deletes one of
            their previous guest inputs
        */
        function removeGuestInput(indexOfEmpty){
            let guestForm = document.getElementById("guestForm");
            // finds all the input values within the guestForm section
            let inputFields = guestForm.getElementsByTagName("input");
            // checks if there are more than one input
            if(inputFields.length > 1){
                // if yes, then it would remove the input box that had their input deleted
                guestForm.removeChild(inputFields[indexOfEmpty]);
            }
            index--;
            guestCount.textContent = index - 1;
        }
        /* 
            creates function to check if input box is empty, this function connects
            to onchange event listeners that are assigned to each guest input box
            before
        */
        function isGuestEmpty(element, indexOfChanged){
            // finds all the input boxes in the guestForm section
            let guestForm = document.getElementById("guestForm");
            let inputFields = guestForm.getElementsByTagName("input");
            // using the parameters needed, do actions based on conditions
            if(element.value == ""){
                removeGuestInput(indexOfChanged);
            } else if(inputFields[inputFields.length-1].value !== ""){
                addGuestInput();
            }
        }
    </script>
    <!-- Internal Script for Form Validation -->
    <script>
        /*
            creates function to validate inputs based on the regular expression
            (regex) given then changes the style of the input border and adds
            or removes the error message based on if the input is validated
            or not
        */
        function validate(element, pattern, errorId){
            const error = document.getElementById(errorId);
            // checks if input is empty or if it matches the regex
            if(element.value=="" || pattern.test(element.value)){
                element.style.border="1px solid black";
                error.classList.add("hidden");
            } else {
                element.style.border="2px solid red";
                error.classList.remove("hidden");                
            }
        }
        /*
            creates function to check if input is empty and thus resets the
            input box styles and error message
        */
        function isEmpty(element, errorId){
            const error = document.getElementById(errorId);
            if(element.value != ""){
                element.style.border = "1px solid black";
                error.classList.add("hidden");
            }
        }
        /* 
            creates function to automatically format phone to required format
            if user inputs only the numbers without the dashes
        */
        function formatPhone(element){
            const phoneValue = element.value;
            const numberOnly = /^\d{10}$/;
            // if phone matches regex of only numbers
            if(numberOnly.test(phoneValue)){
                // then it immediately adds dashes to the numbers
                element.value = element.value.substring(0,3)+"-"+element.value.substring(3,6)+"-"+element.value.substring(6,11);
            }
        }
    </script>
</html>
